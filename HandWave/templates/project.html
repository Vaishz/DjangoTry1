<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Input Detection</title>
    <style>
        /* CSS style to flip the video horizontally */
        #webcam {
            transform: scaleX(-1);
        }
        
        /* CSS style to flip the captured image horizontally */
        #capturedImage {
            transform: scaleX(-1);
        }
    </style>
</head>
<body>
    <h1>Camera Input Detection</h1>
    
    <select id="cameraSelect"></select> <!-- Select element for choosing the camera -->
    <video id="webcam" autoplay></video>
    <button id="captureButton">Capture Image</button>
    <canvas id="canvas" style="display: none;"></canvas>
    <img id="capturedImage" src="" style="display: none;" alt="Captured Image">
    <p id="detectionResult"></p>
    
    <script>
        const videoElement = document.getElementById("webcam");
        const canvasElement = document.getElementById("canvas");
        const capturedImageElement = document.getElementById("capturedImage");
        const detectionResultElement = document.getElementById("detectionResult");
        const captureButton = document.getElementById("captureButton");
        const cameraSelect = document.getElementById("cameraSelect"); // Select element for choosing the camera
        
        let stream;
        let imageCapture;
        
        async function startCamera() {
            try {
                const devices = await navigator.mediaDevices.enumerateDevices();
                const videoDevices = devices.filter(device => device.kind === 'videoinput');
                
                // Populate the camera select options
                videoDevices.forEach(device => {
                    const option = document.createElement('option');
                    option.value = device.deviceId;
                    option.text = device.label || `Camera ${cameraSelect.options.length + 1}`;
                    cameraSelect.appendChild(option);
                });
                
                // Start the camera with the selected device
                const deviceId = cameraSelect.value || videoDevices[0].deviceId;
                stream = await navigator.mediaDevices.getUserMedia({ video: { deviceId } });
                videoElement.srcObject = stream;
                const track = stream.getVideoTracks()[0];
                imageCapture = new ImageCapture(track);
            } catch (error) {
                console.error("Error accessing the camera:", error);
            }
        }
        
        function captureImage() {
            canvasElement.width = videoElement.videoWidth;
            canvasElement.height = videoElement.videoHeight;
            canvasElement.getContext("2d").drawImage(videoElement, 0, 0);
            capturedImageElement.src = canvasElement.toDataURL("image/jpeg");
            capturedImageElement.style.display = "block";
            
            // Call detectHandSign function to detect hand sign
            detectHandSign();
        }
        
        async function detectHandSign() {
            // Here you can implement your hand sign detection logic
            // You can send the captured image to your backend for detection
            
            // For demonstration, let's display a placeholder result
            detectionResultElement.textContent = "Detected: Sign A";
        }
        
        // Event listener for capture button click
        captureButton.addEventListener("click", captureImage);
        
        // Event listener for camera selection change
        cameraSelect.addEventListener("change", async () => {
            // Stop the current stream
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            // Start camera with the selected device
            startCamera();
        });
        
        // Start camera when the page loads
        window.onload = startCamera;
    </script>
</body>
</html>
